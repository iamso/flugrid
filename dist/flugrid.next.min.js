/*!
 * flugrid - version 0.1.0
 *
 * Made with â¤ by Steve Ottoz so@dev.so
 *
 * Copyright (c) 2017 Steve Ottoz
 */
'use strict';export default class Flugrid{constructor({container:c='.flugrid',items:d='.flugrid-item',gutter:e=0,auto:f=!1,rtl:g=!1}={}){this.set({container:c,items:d,gutter:e,rtl:g}),this.auto=!!f,this.init()}init(){this.auto&&(this.build(),this.resizeHandler=this.build.bind(this),window.addEventListener('resize',this.resizeHandler))}set({container:c=this.container,items:d=this.items,gutter:e=this.gutter,rtl:f=this.rtl}={}){this.container=c instanceof Node?c:document.querySelector(c),this.items=d instanceof NodeList?d:this.container.querySelectorAll(d),this.gutter=isFinite(parseInt(e))?parseInt(e):0,this.rtl=!!f}build(){return new Promise((c,d)=>{this.container.style.width='';const e=this.container.getBoundingClientRect().width,f=this.items[0].getBoundingClientRect().width+this.gutter,g=Math.max(Math.floor((e-this.gutter)/f),1),h=[],j=[];this.container.style.width=`${f*g+this.gutter}px`;;this.container.style.position='relative';for(let l of Array(g).keys())j.push(l*f+this.gutter),h.push(this.gutter);this.rtl&&j.reverse();for(let l of this.items){let m=h.slice(0).sort(function(p,q){return p-q}).shift();m=h.indexOf(m);const n=parseInt(j[m]),o=parseInt(h[m]);l.style.position='absolute',l.style.webkitBackfaceVisibility=l.style.backfaceVisibility='hidden',l.style.transformStyle='preserve-3d',l.style.transform=`translate3D(${n}px, ${o}px, 0)`,h[m]+=l.getBoundingClientRect().height+this.gutter}const k=h.slice(0).sort(function(l,m){return l-m}).pop();this.container.style.height=`${k}px`,c(this)})}reset(){this.container.style.position='',this.container.style.width='',this.container.style.height='';for(let c of this.items)c.style.position='',c.style.webkitBackfaceVisibility=c.style.backfaceVisibility='',c.style.transformStyle='',c.style.transform=''}destroy(){this.reset(),this.auto&&window.removeEventListener('resize',this.resizeHandler)}}