/*!
 * flugrid - version 0.2.0
 *
 * Made with ‚ù§ by Steve Ottoz so@dev.so
 *
 * Copyright (c) 2020 Steve Ottoz
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Flugrid=e()}(this,(function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function i(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,e){if(t){if("string"==typeof t)return n(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return s=t.done,t},e:function(t){l=!0,a=t},f:function(){try{s||null==i.return||i.return()}finally{if(l)throw a}}}}return function(){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.container,r=void 0===i?".flugrid":i,o=e.items,a=void 0===o?".flugrid__item":o,s=e.gutter,l=void 0===s?0:s,u=e.auto,c=void 0!==u&&u,f=e.rtl,h=void 0!==f&&f;t(this,n),this.set({container:r,items:a,gutter:l,rtl:h}),this.auto=!!c,this.init()}var r,o,a;return r=n,(o=[{key:"init",value:function(){this.auto&&(this.build(),this.resizeHandler=this.build.bind(this),window.addEventListener("resize",this.resizeHandler))}},{key:"set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.container,n=void 0===e?this.container:e,i=t.items,r=void 0===i?this.items:i,o=t.gutter,a=void 0===o?this.gutter:o,s=t.rtl,l=void 0===s?this.rtl:s;this.container=n instanceof Node?n:document.querySelector(n),this.items=this.container?[].slice.call(r instanceof NodeList?r:this.container.querySelectorAll(r),0):[],this.gutter=isFinite(parseInt(a))?parseInt(a):0,this.rtl=!!l}},{key:"build",value:function(){var t=this;return new Promise((function(e,n){if(t.container&&t.items.length){t.container.style.width="";var r=t.container.getBoundingClientRect().width,o=t.items[0].getBoundingClientRect().width+t.gutter,a=Math.max(Math.floor((r-t.gutter)/Math.floor(o)),1),s=[],l=[];t.container.style.width="".concat(o*a+t.gutter,"px"),t.container.style.position="relative";for(var u=0;u<a;u++)l.push(u*o+t.gutter),s.push(t.gutter);t.rtl&&l.reverse();var c,f=i(t.items);try{for(f.s();!(c=f.n()).done;){var h=c.value,d=s.slice(0).sort((function(t,e){return t-e})).shift();d=s.indexOf(d);var y=parseInt(l[d]),v=parseInt(s[d]);h.style.position="absolute",h.style.webkitBackfaceVisibility=h.style.backfaceVisibility="hidden",h.style.transformStyle="preserve-3d",h.style.transform="translate3D(".concat(y,"px, ").concat(v,"px, 0)"),s[d]+=h.getBoundingClientRect().height+t.gutter}}catch(t){f.e(t)}finally{f.f()}var g=s.slice(0).sort((function(t,e){return t-e})).pop();t.container.style.height="".concat(g,"px")}e(t)}))}},{key:"reset",value:function(){this.container.style.position="",this.container.style.width="",this.container.style.height="";var t,e=i(this.items);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.style.position="",n.style.webkitBackfaceVisibility=n.style.backfaceVisibility="",n.style.transformStyle="",n.style.transform=""}}catch(t){e.e(t)}finally{e.f()}}},{key:"destroy",value:function(){this.reset(),this.auto&&window.removeEventListener("resize",this.resizeHandler)}}])&&e(r.prototype,o),a&&e(r,a),n}()}));
